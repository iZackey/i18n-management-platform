(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["langDetail"],{"07a2":function(e,t,i){var r=i("8a1c");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},"0dbc":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"clearfix",class:e.prefixCls,attrs:{"element-loading-text":e.loadingText}},[i("div",{staticClass:"clearfix",class:e.prefixCls+"-top"},[i("h1",[i("span",[e._v("语言包详情")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"温馨提示：双击下面数据可以在线编辑；列的宽度可拖拽调整；",placement:"right"}},[i("i",{staticClass:"el-icon-info"})])],1),i("h2",{staticClass:"lib-name"},[e._v(" 语言包名称："+e._s(e.libName)+" ")])]),i("div",{staticClass:"button-list clearfix"},[i("div",{staticClass:"left"},[e.parentId&&"0"!=e.parentId?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.gobackTop}},[e._v("返回顶级")]):e._e(),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleAddChildGrade}},[e._v("添加"+e._s(e.parentId?"子":"")+"字段")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleBatchAddChildGrade}},[e._v("批量添加"+e._s(e.parentId&&"0"!=e.parentId?"子":"")+"字段")]),e.parentId&&"0"!=e.parentId?i("span",{staticStyle:{"margin-left":"10px"}},[e._v("父字段为："+e._s(e.formatParentKey(e.parentKey)))]):e._e()],1),i("div",{staticClass:"right"},[i("div",{staticClass:"search-wrapper"},[i("el-input",{staticClass:"input-with-select",attrs:{size:"small",clearable:"",placeholder:"请输入关键词搜索"},on:{clear:e.handlerSearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handlerSearch(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[i("el-select",{staticStyle:{width:"100px","text-align":"center"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[i("el-option",{attrs:{label:"包内搜索",value:"1"}}),i("el-option",{attrs:{label:"全局搜索",value:"2"}})],1),i("el-button",{attrs:{slot:"append",size:"small",icon:"el-icon-search"},on:{click:e.handlerSearch},slot:"append"})],1)],1),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.previewJson()}}},[e._v("预览&导出JSON")])],1)]),i("div",{staticClass:"page-table-data",attrs:{id:e.prefixCls+"-page-table"}},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.tableData,height:e.tableHeight,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"iIndex",label:"序号",align:"center",width:"50"}}),i("el-table-column",{attrs:{prop:"id",label:"ID",align:"center","class-name":"field-id",width:"70"}}),i("el-table-column",{attrs:{prop:"key",label:"字段名","class-name":"field-name"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.parent_key?i("div",{staticStyle:{display:"inline"}},e._l(t.row.parent_key,(function(r,n){return i("span",{key:n,attrs:{title:"进入子级"},on:{click:function(i){return e.goToChildrenKeys(t.row,n)}}},[i("i",{staticClass:"parent-key"},[e._v(e._s(r))]),e._v(" / ")])})),0):e._e(),t.row.keyIsEdit?[i("el-input",{ref:"key"+t.row.id,staticStyle:{width:"150px"},attrs:{type:"text"},on:{blur:function(i){return e.blurEdit(t.row,"key")}},model:{value:t.row.key,callback:function(i){e.$set(t.row,"key",i)},expression:"scope.row.key"}})]:[i("span",{on:{dblclick:function(i){return e.dblclickEdit(t.row,"key")}}},[e._v(e._s(t.row.key))]),"1"==t.row.is_has_children?i("span",{staticClass:"parent-key",staticStyle:{"margin-left":"10px"},on:{click:function(i){return e.goToChildrenKeys(t.row)}}},[e._v("进入子级")]):e._e()],i("el-button",{staticClass:"cell-btn-copy",attrs:{size:"mini",type:"success",plain:"",title:"复制key的完整路径"},nativeOn:{click:function(i){return e.copyFullKeyPath(t.row)}}},[e._v("复制")])]}}])},[i("template",{slot:"header"},[e._v(" 字段名 ")])],2),i("el-table-column",{attrs:{prop:"zh",label:"中文(zh)"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.zhIsEdit?[i("el-input",{ref:"zh"+t.row.id,attrs:{type:"text"},on:{blur:function(i){return e.blurEdit(t.row,"zh")}},model:{value:t.row.zh,callback:function(i){e.$set(t.row,"zh",i)},expression:"scope.row.zh"}})]:["1"!=t.row.is_has_children?i("p",{staticClass:"lang-field-content",on:{dblclick:function(i){return e.dblclickEdit(t.row,"zh")}}},[e._v(e._s(t.row.zh))]):e._e(),i("i",{staticClass:"el-icon-search find-translate-from-history",attrs:{title:"查找历史翻译"},on:{click:function(i){return e.findHistoryTranslate(t.row)}}})]]}}])}),i("el-table-column",{attrs:{prop:"en",label:"English(en)"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enIsEdit?[i("el-input",{ref:"en"+t.row.id,attrs:{type:"text"},on:{blur:function(i){return e.blurEdit(t.row,"en")}},model:{value:t.row.en,callback:function(i){e.$set(t.row,"en",i)},expression:"scope.row.en"}})]:["1"!=t.row.is_has_children?i("p",{staticClass:"lang-field-content",on:{dblclick:function(i){return e.dblclickEdit(t.row,"en")}}},[e._v(e._s(t.row.en))]):e._e()]]}}])}),i("el-table-column",{attrs:{prop:"update_time",label:"更新时间",width:"160px"}}),i("el-table-column",{attrs:{prop:"user_name",label:"最后修改人",width:"110px"}}),i("el-table-column",{attrs:{label:"操作",width:"200px","class-name":"field-opration"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticClass:"btn-add-children",attrs:{size:"mini",type:"success",plain:""},on:{click:function(i){return e.handleAddBrotherGrade(t.row)}}},[e._v("增加同级")]),i("el-button",{staticClass:"btn-add-children",attrs:{size:"mini",type:"success",plain:""},on:{click:function(i){return e.handleAddChildGrade(t.row)}}},[e._v("增加子级")]),i("el-button",{staticClass:"btn-delete",attrs:{size:"mini",type:"danger",plain:""},on:{click:function(i){return e.handleDeleteData(t.row)}}},[e._v("删除")])]}}])})],1)],1),i("div",{class:[e.prefixCls+"-pager"]},[i("el-pagination",{attrs:{size:"small",background:"",layout:"total, prev, pager, next, sizes","page-sizes":[10,20,50,100],"page-size":Number(e.pageSize),total:Number(e.pageTotal),"current-page":Number(e.pageNo)},on:{"current-change":e.onChangePageNo,"size-change":e.onPageSizeChange}})],1),i("div",{class:e.prefixCls+"-copy-text-wrapper"},[i("textarea",{class:e.prefixCls+"-copy-text"})]),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.addFieldForm.parent_id&&"0"!=e.addFieldForm.parent_id?"增加子结点":"增加结点","custom-class":"addField_cancel",visible:e.addFieldForm.addFieldCancel,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(t){return e.$set(e.addFieldForm,"addFieldCancel",t)}}},[e.addFieldForm.addFieldCancel?i("el-form",{ref:"addFieldForm",attrs:{size:"small",model:e.addFieldForm,"label-width":"120px",rules:e.rules}},[e.addFieldForm.parent_id&&"0"!=e.addFieldForm.parent_id?i("el-form-item",{attrs:{label:"父级名称："}},[e._v(" "+e._s(e.addFieldForm.parent_key)+" ")]):e._e(),i("el-form-item",{attrs:{label:"字段名",size:"small",prop:"name"}},[i("el-input",{model:{value:e.addFieldForm.key,callback:function(t){e.$set(e.addFieldForm,"key",t)},expression:"addFieldForm.key"}})],1),i("el-form-item",{attrs:{label:"中文",size:"small",prop:"zh_cn"}},[i("el-input",{model:{value:e.addFieldForm.zh,callback:function(t){e.$set(e.addFieldForm,"zh",t)},expression:"addFieldForm.zh"}})],1),i("el-form-item",{attrs:{label:"英文",size:"small",prop:"en_cn"}},[i("el-input",{model:{value:e.addFieldForm.en,callback:function(t){e.$set(e.addFieldForm,"en",t)},expression:"addFieldForm.en"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addFieldSubmit}},[e._v("保 存")]),i("el-button",{attrs:{size:"small"},on:{click:function(t){e.addFieldForm.addFieldCancel=!1}}},[e._v("取 消")])],1)],1):e._e()],1),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"批量"+(e.parentId?"增加子结点":"增加结点"),visible:e.batchAddFieldForm.isShow,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){return e.$set(e.batchAddFieldForm,"isShow",t)}}},[e.batchAddFieldForm.isShow?i("el-form",{ref:"batchAddFieldForm",class:[e.prefixCls+"-batchAddFieldForm"],attrs:{size:"small",model:e.batchAddFieldForm,"label-width":"0px",rules:e.batchRules}},[i("el-form-item",{attrs:{size:"small",prop:"jsonStr"}},[i("div",[e._v(' 在此处粘贴json字符串，以便快速添加，格式如：{"a": "我是A"} ')]),i("div",[i("el-input",{attrs:{type:"textarea",rows:20,autofocus:""},model:{value:e.batchAddFieldForm.jsonStr,callback:function(t){e.$set(e.batchAddFieldForm,"jsonStr",t)},expression:"batchAddFieldForm.jsonStr"}})],1)]),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.batchAddFieldSubmit}},[e._v("保 存")]),i("el-button",{attrs:{size:"small"},on:{click:function(t){e.batchAddFieldForm.isShow=!1}}},[e._v("取 消")])],1)],1):e._e()],1),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"预览json",visible:e.previewJsonObj.isShow,"close-on-click-modal":!1,width:"90%"},on:{"update:visible":function(t){return e.$set(e.previewJsonObj,"isShow",t)}}},[i("div",{class:e.prefixCls+"-preview-json-text"},[i("ul",{staticClass:"title"},[i("li",[e._v(" 中文json "),i("a",{attrs:{href:"javascript:void (0)"},on:{click:function(t){return e.copyText(e.previewJsonObj.jsonStrZh)}}},[e._v("复制代码")]),i("a",{attrs:{href:"javascript:void (0)"},on:{click:function(t){return e.downloadFile("zh.json",e.previewJsonObj.jsonStrZh)}}},[e._v("下载JSON")])]),i("li",[e._v(" 繁体中文json "),i("a",{attrs:{href:"javascript:void (0)"},on:{click:function(t){return e.copyText(e.previewJsonObj.jsonStrZhHk)}}},[e._v("复制代码")]),i("a",{attrs:{href:"javascript:void (0)"},on:{click:function(t){return e.downloadFile("zh-hk.json",e.previewJsonObj.jsonStrZhHk)}}},[e._v("下载JSON")])]),i("li",[e._v(" 英文json "),i("a",{attrs:{href:"javascript:void (0)"},on:{click:function(t){return e.copyText(e.previewJsonObj.jsonStrEn)}}},[e._v("复制代码")]),i("a",{attrs:{href:"javascript:void (0)"},on:{click:function(t){return e.downloadFile("en.json",e.previewJsonObj.jsonStrEn)}}},[e._v("下载JSON")])])]),i("ul",[i("li",[i("el-input",{attrs:{type:"textarea",rows:20,autofocus:"",spellcheck:"false",readonly:""},model:{value:e.previewJsonObj.jsonStrZh,callback:function(t){e.$set(e.previewJsonObj,"jsonStrZh",t)},expression:"previewJsonObj.jsonStrZh"}})],1),i("li",[i("el-input",{attrs:{type:"textarea",rows:20,autofocus:"",spellcheck:"false",readonly:""},model:{value:e.previewJsonObj.jsonStrZhHk,callback:function(t){e.$set(e.previewJsonObj,"jsonStrZhHk",t)},expression:"previewJsonObj.jsonStrZhHk"}})],1),i("li",[i("el-input",{attrs:{type:"textarea",rows:20,autofocus:"",spellcheck:"false",readonly:""},model:{value:e.previewJsonObj.jsonStrEn,callback:function(t){e.$set(e.previewJsonObj,"jsonStrEn",t)},expression:"previewJsonObj.jsonStrEn"}})],1)])])]),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"预览("+e.previewJsonBeforeDownload.title+")，待下载",visible:e.previewJsonBeforeDownload.isShow,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(t){return e.$set(e.previewJsonBeforeDownload,"isShow",t)}}},[i("div",{class:e.prefixCls+"-preview-json-text"},[i("div",{staticClass:"preview-content"},[i("el-input",{attrs:{type:"textarea",rows:20,autofocus:"",spellcheck:"false",readonly:""},model:{value:e.previewJsonBeforeDownload.jsonStr,callback:function(t){e.$set(e.previewJsonBeforeDownload,"jsonStr",t)},expression:"previewJsonBeforeDownload.jsonStr"}})],1),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.copyText(e.previewJsonBeforeDownload.jsonStr)}}},[e._v("复制代码")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.downloadFile(e.previewJsonBeforeDownload.type+".json",e.previewJsonBeforeDownload.jsonStr)}}},[e._v("下载JSON")])],1)])]),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"全局查看历史相关翻译",visible:e.isShowHistoryTransDialog,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.isShowHistoryTransDialog=t}}},[i("div",{class:e.prefixCls+"-translate-from-history"},[i("div",{staticClass:"history-search"},[i("el-input",{staticClass:"input-with-select",attrs:{size:"small",clearable:"",placeholder:"请输入关键词搜索"},on:{clear:e.handlerHistorySearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handlerHistorySearch(t)}},model:{value:e.historyKeyword,callback:function(t){e.historyKeyword=t},expression:"historyKeyword"}},[i("el-select",{staticStyle:{width:"100px","text-align":"center"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.historySearchType,callback:function(t){e.historySearchType=t},expression:"historySearchType"}},[i("el-option",{attrs:{label:"模糊匹配",value:"1"}}),i("el-option",{attrs:{label:"精确匹配",value:"2"}})],1),i("el-button",{attrs:{slot:"append",size:"small",icon:"el-icon-search"},on:{click:e.handlerHistorySearch},slot:"append"})],1)],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.historyTransData,height:500,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"id",label:"ID",align:"center",width:"80"}}),i("el-table-column",{attrs:{prop:"key",label:"字段名",width:"100"}}),i("el-table-column",{attrs:{prop:"lib_name",label:"所属语言包",width:"100"}}),i("el-table-column",{attrs:{prop:"zhStr",label:"中文",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{display:"inline"},domProps:{innerHTML:e._s(t.row.zhStr)}})]}}])}),i("el-table-column",{attrs:{prop:"en",label:"英文"}})],1),i("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[i("el-pagination",{attrs:{size:"small",background:"",layout:"total, prev, pager, next","page-size":Number(e.historyPageSize),total:Number(e.historyPageTotal),"current-page":Number(e.historyPageNo)},on:{"current-change":e.onChangeHistoryPageNo}})],1)],1)])],1)},n=[];i("b4fb"),i("fe59"),i("9302"),i("6ae3"),i("2eeb"),i("ea69"),i("053b"),i("513c"),i("fe8a"),i("e18c"),i("84c2"),i("e35a"),i("1c2e"),i("96db"),i("5e9f"),i("0d7a"),i("6db4"),i("08ba"),i("af86");function a(e){if(Array.isArray(e))return e}i("f3dd"),i("0a51"),i("9b11");function o(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(i.push(o.value),t&&i.length===t)break}catch(l){n=!0,a=l}finally{try{r||null==s["return"]||s["return"]()}finally{if(n)throw a}}return i}}var s=i("2c3f");function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){return a(e)||o(e,t)||Object(s["a"])(e,t)||l()}var c=i("f0ee"),u=i("a7c7"),h=i("2ba1"),p=i("ab3e"),f=i("b893"),b=(i("35f4e"),i("b130"),i("90aa"),i("a59a"));b["default"].directive("dialogDrag",{bind:function(e,t,i,r){var n=e.querySelector(".el-dialog__header"),a=e.querySelector(".el-dialog");n.style.cursor="move";var o=a.currentStyle||window.getComputedStyle(a,null);n.onmousedown=function(e){var t,i,r=e.clientX-n.offsetLeft,s=e.clientY-n.offsetTop;o.left.includes("%")?(t=Number(document.body.clientWidth)*(Number(o.left.replace(/\%/g,""))/100),i=Number(document.body.clientHeight)*(Number(o.top.replace(/\%/g,""))/100)):(t=Number(o.left.replace(/px/g,"")),i=Number(o.top.replace(/px/g,""))),document.onmousemove=function(e){var n=e.clientX-r,o=e.clientY-s;a.style.left="".concat(n+t,"px"),a.style.top="".concat(o+i,"px")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}});var y=i("fa7d"),m={data:function(){return{prefixCls:"views-lang-detail",isLoading:!1,loadingText:"加载中，请稍后...",libName:"",rules:{},batchRules:{},addFieldForm:{addFieldCancel:!1,parent_key:"",parent_id:"",zh:"",en:""},batchAddFieldForm:{isShow:!1,jsonStr:""},previewJsonObj:{isShow:!1,jsonStrZh:"",jsonStrEn:""},previewJsonBeforeDownload:{isShow:!1,jsonStr:"",title:"",type:""},libId:"",parentId:"",parentKey:"",idIndex:0,tableData:[],isEditing:!1,brotherList:[],uploadJsonHasArray:!1,pageSize:50,pageTotal:0,pageNo:1,tableHeight:200,keyword:"",isShowHistoryTransDialog:!1,historyTransData:[],historyPageSize:20,historyPageNo:1,historyPageTotal:0,searchType:"1",historySearchType:"1",historyKeyword:""}},watch:{"$route.query.parentId":function(e,t){e!=t&&this.init()}},mounted:function(){var e=this;this.init(),this.getLibInfo(),setTimeout((function(){e.setTableHeight()}),20),window.addEventListener("resize",this.setTableHeight)},beforeDestroy:function(){window.removeEventListener("resize",this.setTableHeight)},methods:{init:function(){this.libId=this.$route.query.libId;var e=this.$route.query.parentId;this.parentId=e&&"0"!=e?e:"",this.pageNo=1,this.getDetail()},getLangList:function(){return new Promise((function(e,t){Object(p["a"])({url:"getLangListByTypeId",data:{typeId:""}}).then((function(t){var i={};if("true"==t.result){var r=t.data||[];r.forEach((function(e){i[e.id]=e.name}))}e(i)}))}))},handlerHistorySearch:function(){this.findHistoryTranslate({id:"0",zh:(this.historyKeyword||"").trim(),historySearchType:this.historySearchType})},findHistoryTranslate:function(e){var t=this;e&&(this.isLoading=!0),this.isShowHistoryTransDialog=!0;var i=e||this.historyRow;this.historyKeyword=i.zh,this.getLangList().then((function(r){Object(p["a"])({url:"fields/findHistoryTranslate",data:{keyword:i.zh,id:i.id,historySearchType:i.historySearchType,pageSize:Number(t.historyPageSize),pageNo:Number(t.historyPageNo)}}).then((function(n){if(e&&(t.historyRow=e,t.isLoading=!1),"true"==n.result){var a=new RegExp(i.zh,"g");t.historyTransData=(n.list||[]).map((function(e,t){return Object(h["a"])(Object(h["a"])({},e),{},{iIndex:t+1,lib_name:r[e.lib_id],zhStr:e.zh.replace(a,(function(e,t){return'<strong style="color: red;">'+e+"</strong>"}))})})),t.historyPageTotal=n.total||0}}))}))},copyFullKeyPath:function(e){this.copyText([].concat(Object(u["a"])(e.parent_key||[]),[e.key]).join("."))},copyText:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.querySelector("."+this.prefixCls+"-copy-text");t.value=e,t.select(),document.execCommand("Copy"),t.value="",this.$showOk("复制成功，可贴粘！")},setTableHeight:function(){this.tableHeight=document.documentElement.clientHeight-document.querySelector("#"+this.prefixCls+"-page-table").getBoundingClientRect().top-75},gobackTop:function(){this.pageNo=1,this.keyword="",this.$router.push({path:this.$route.path,query:{libId:this.$route.query.libId}})},handlerSearch:function(){var e=this.keyword.trim();if("1"==this.searchType)if(this.keyword=e,this.pageNo=1,this.$route.query.parentId){var t=Object(h["a"])({},this.$route.query);delete t.parentId,this.$router.push({path:this.$route.path,query:Object(h["a"])({},t)})}else this.getDetail();else this.isShowHistoryTransDialog=!0,this.findHistoryTranslate({id:"0",zh:e})},getLibInfo:function(){var e=this;Object(p["a"])({url:"lib/getLibInfo",method:"post",data:{id:this.libId}}).then((function(t){"true"==t.result&&(e.libName=(t.data||{}).name)}))},onChangePageNo:function(e){var t=this;this.pageNo=String(e),this.getDetail((function(){t.$refs.multipleTable.bodyWrapper.scrollTop=0}))},onChangeHistoryPageNo:function(e){this.historyPageNo=String(e),this.findHistoryTranslate()},onPageSizeChange:function(e){var t=this;this.pageSize=String(e),this.getDetail((function(){t.$refs.multipleTable.bodyWrapper.scrollTop=0}))},getDetail:function(e,t){var i=this;t||(this.isLoading=!0),Object(p["a"])({url:"fields/list",data:{lib_id:this.libId,parent_id:this.parentId&&"0"!=this.parentId?this.parentId:"",pageSize:Number(this.pageSize),pageNo:Number(this.pageNo),keyword:this.keyword}}).then((function(r){"true"==r.result&&(i.tableData=(r.list||[]).map((function(e,t){return Object(h["a"])(Object(h["a"])({},e),{},{iIndex:t+1,parent_key:e.parent_key?e.parent_key.split(","):[]})})),i.pageTotal=r.total||0,i.parentKey=r.parent_key_arr||[]),t||(i.isLoading=!1),"function"==typeof e&&e()}))},formatParentKey:function(e){return Array.isArray(e)?e.join(" / "):""},goToChildrenKeys:function(e,t){if(this.pageNo=1,this.keyword="","1"!=e.is_has_children){for(var i=e.parent_id&&"0"!=e.parent_id?String(e.parent_id).split(","):[],r="",n=0;n<i.length;n++)n<=t+1&&(r+=(0===n?"":",")+i[n]);if(r==this.parentId)return;r&&this.$router.push({path:this.$route.path,query:Object(h["a"])(Object(h["a"])({},this.$route.query),{},{parentId:r})})}else"1"==e.is_has_children&&this.$router.push({path:this.$route.path,query:Object(h["a"])(Object(h["a"])({},this.$route.query),{},{parentId:(e.parent_id?e.parent_id+",":"")+e.id})})},handleAddChildGrade:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isEditing)return this.$showError("有一条数据正在编辑中！"),!1;e.id?this.addFieldForm={addFieldCancel:!0,parent_key:e.parent_key?e.parent_key.join(" / ")+(e.parent_key.length?" / ":"")+e.key:"",parent_id:e.parent_id?e.parent_id+","+e.id:"",key:"",zh:"",en:""}:this.parentId&&"0"!=this.parentId?this.addFieldForm={addFieldCancel:!0,parent_key:this.parentKey.join(" / "),parent_id:"".concat(this.parentId),key:"",zh:"",en:""}:this.addFieldForm={addFieldCancel:!0,parent_key:"",parent_id:"0",key:"",zh:"",en:""}},handleAddBrotherGrade:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.addFieldForm={addFieldCancel:!0,parent_key:e.parent_key?e.parent_key.join(" / "):"",parent_id:e.parent_id?e.parent_id:"",key:"",zh:"",en:""}},handleBatchAddChildGrade:function(){var e=this.batchAddFieldForm;e.isShow=!0,e.jsonStr="",this.batchAddFieldForm=e},addFieldSubmit:function(){var e=this,t=this.addFieldForm;if(""===$.trim(t.key||""))return this.$showError("字段名不能为空！"),!1;Object(p["a"])({url:"fields/addFields",data:{zh:t.zh||"",en:t.en||"",key:t.key,lib_id:this.libId,parent_id:t.parent_id||"0"}}).then((function(t){"true"==t.result&&(e.$showOk("添加成功"),e.addFieldForm.addFieldCancel=!1,e.getDetail())}))},batchAddFieldSubmit:function(){var e=this,t=this.batchAddFieldForm;if(t.jsonStr.trim()){var i=!0,r=null;try{r=JSON.parse(t.jsonStr)}catch(c){i=!1}if(i&&r){var n=[];for(var a in r)n.push({key:a,zh:r[a]});var o=0,s=0,l=[],d=function t(i){if(o>=n.length){var r="批量添加完毕";s>0&&(r+="，其中失败了"+s+"个");var a=[];return l.forEach((function(e){a.push('<tr><td style="padding: 2px 5px;">'.concat(e.key,'</td><td style="padding: 2px 5px;">').concat(e.resultDes,"</td></tr>"))})),e.$alert('\n                        <div>\n                            <div style="font-size: 14px;line-height: 28px;">'.concat(r,'</div>\n                            <div style="display: ').concat(s>0?"block":"none",'; max-height: 300px;overflow: auto;">\n                                <div><strong>失败原因如下：</strong></div>\n                                <table cellpadding="2" cellspacing="0" border="1" bordercolor="#ccc" width="100%">\n                                    <tr><th style="padding: 2px 5px;">key</th><th style="padding: 2px 5px;">失败说明</th></tr>\n                                   ').concat(a.join(""),"\n                                </table>\n                            </div>\n                        </div>\n                    "),"提示",{dangerouslyUseHTMLString:!0}),e.isLoading=!1,void e.getDetail()}Object(p["a"])({url:"fields/addFields",data:{zh:i.zh||"",key:i.key,lib_id:e.libId,parent_id:e.parentId&&"0"!=e.parentId?"".concat(e.parentId):"0"},isPassFalse:!0}).then((function(e){"true"==e.result||(s++,l.push({key:i.key,resultDes:e.resultDes||"未知原因"})),o++,t(n[o])}))};t.isShow=!1,this.isLoading=!0,d(n[o])}else this.$showError("json字符串格式不正确")}else this.$showError("json字符串内容不能为空")},handleDeleteData:function(e){var t=this,i=this,r="确定要删除（"+e.key+"）这条数据吗？";if(i.isEditing)return f["a"].showMsg.error("有一条数据正在编辑中！"),!1;e.children&&e.children.length>0&&(r="当前数据中含有子级，确定要删除这条数据吗？"),i.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.isLoading=!0,Object(p["a"])({url:"fields/delete",data:{id:e.id}}).then((function(e){t.isLoading=!1,"true"==e.result&&(t.$showOk("删除成功"),t.getDetail())}))})).catch((function(){}))},funcData:function(e,t,i){var r=this;return e.forEach((function(n,a){n.id==t?"addChild"==i?n.children.push({id:(new Date).getTime(),name:$.trim(r.addFieldForm.name),zh_cn:$.trim(r.addFieldForm.zh_cn),en_cn:$.trim(r.addFieldForm.en_cn),children:[],nameIsEdit:!1,zh_cnIsEdit:!1,en_cnIsEdit:!1}):"delete"==i&&e.splice(a,1):n.children&&n.children.length>0&&r.funcData(n.children,t,i)})),e},dblclickEdit:function(e,t){var i=this;"1"!=e.is_has_children?this.isEditing?this.$showError("有一条数据正在编辑中！"):(e[t+"IsEdit"]=!0,e.oldValues=Object(h["a"])({},e),this.isEditing=!0,this.tableData=JSON.parse(JSON.stringify(this.tableData)),this.$nextTick((function(){i.$refs[t+e.id]&&i.$refs[t+e.id].focus()}))):this.$showError("不允许直接编辑父级")},blurEdit:function(e,t){var i=this,r=function(){delete e.oldValues,e[t+"IsEdit"]=!1,i.isEditing=!1},n=function(){e[t]=e.oldValues[t],delete e.oldValues,e[t+"IsEdit"]=!1,i.isEditing=!1};if(e.oldValues&&e.oldValues[t]==e[t])return this.$showOk("没修改"),void r();this.isLoading=!0,Object(p["a"])({url:"fields/updateFields",data:{lib_id:e.lib_id,id:e.id,zh:e.zh,en:e.en,key:e.key}}).then((function(e){i.isLoading=!1,"true"==e.result?(i.$showOk("更新成功"),r(),i.getDetail((function(){}),!0)):n()}))},getBrother:function(e,t){var i=this;t.forEach((function(r){r.id==e.id?i.brotherList=t:r.children.length>0&&i.getBrother(e,r.children)}))},verifySameNameBlur:function(e,t){var i=!1,r=0;if(t&&t.length>0)for(var n in t)t[n].name==e&&r++;return r>1&&(i=!0),i},verifySameName:function(e,t){var i=!1;if(t&&t.length>0)for(var r in t)t[r].name==e&&(i=!0);return i},goback:function(){this.$router.go(-1)},onChangeFile:function(e){var t=this,i=this;i.$confirm("上传文件将覆盖表格数据，确定要执行此操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(t.$refs.fileEle.files[0]){if(".json"!=t.getExtensions(t.$refs.fileEle.files[0].name))return f["a"].showMsg.error("只能上传json文件！"),!1;var e=new FileReader;e.onload=function(e){if(!t.isJsonFormat(e.target.result))return f["a"].showMsg.error("json文件格式不正确！"),!1;t.idIndex=0,t.uploadJsonHasArray=!1;var i=t.uploadJsonToTable(JSON.parse(e.target.result));if(t.uploadJsonHasArray)return f["a"].showMsg.error("json文件格式不正确！"),!1;t.tableData=i},e.readAsText(t.$refs.fileEle.files[0])}})).catch((function(){}))},getExtensions:function(e){return e.substring(e.lastIndexOf("."))},isJsonFormat:function(e){try{e=JSON.parse(e)}catch(t){e=null}return e},uploadJsonToTable:function(e){var t=this;Array.isArray(e)&&(this.uploadJsonHasArray=!0);var i=[];return Object.keys(e).forEach((function(r){""===$.trim(r)&&(t.uploadJsonHasArray=!0),t.idIndex++;var n={id:t.idIndex,name:$.trim(r),en_cn:"",nameIsEdit:!1,zh_cnIsEdit:!1,en_cnIsEdit:!1};"object"==Object(c["a"])(e[r])?(n["zh_cn"]="",n["children"]=t.uploadJsonToTable(e[r])):(n["zh_cn"]=e[r],n["children"]=[]),i.push(n)})),i},downLoad:function(e){var t=this;if(this.isEditing)return f["a"].showMsg.error("有一条数据正在编辑中！"),!1;this.isLoading=!0,Object(p["a"])({url:"fields/exportJson",data:{lib_id:this.libId,lib_lang:"zh-hk"===e?"zh":e}}).then((function(i){if("true"==i.result){var r=y["a"].fieldsArrToJsonList(i.jsonList,e),n={isShow:!0,jsonStr:t.formatJsonStr(JSON.stringify(r)),title:{zh:"简体中文","zh-hk":"繁体中文",en:"English"}[e],type:e};t.previewJsonBeforeDownload=n,t.isLoading=!1}else t.isLoading=!1}))},downloadFile:function(e,t){var i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)},previewJson:function(){var e=this;if(this.isEditing)return f["a"].showMsg.error("有一条数据正在编辑中！"),!1;var t=function(){return new Promise((function(t,i){Object(p["a"])({url:"fields/exportJson",data:{lib_id:e.libId,lib_lang:"zh"}}).then((function(i){if("true"==i.result){var r=y["a"].fieldsArrToJsonList(i.jsonList,"zh"),n=y["a"].fieldsArrToJsonList(i.jsonList,"zh-hk");t({zh:e.formatJsonStr(JSON.stringify(r)),zhHk:e.formatJsonStr(JSON.stringify(n))})}}))}))},i=function(){return new Promise((function(t,i){Object(p["a"])({url:"fields/exportJson",data:{lib_id:e.libId,lib_lang:"en"}}).then((function(i){if("true"==i.result){var r=y["a"].fieldsArrToJsonList(i.jsonList,"en");t(e.formatJsonStr(JSON.stringify(r)))}}))}))};this.isLoading=!0,Promise.all([t(),i()]).then((function(t){var i=d(t,2),r=i[0],n=i[1];e.isLoading=!1;var a=e.previewJsonObj;a.isShow=!0,a.jsonStrZh=r.zh,a.jsonStrZhHk=r.zhHk,a.jsonStrEn=n})).catch((function(){}))},dataToJson:function(e,t){var i=this,r={};return e.forEach((function(e){e.children.length>0?r[e.name]=i.dataToJson(e.children,t):r[e.name]=e[t]})),r},formatJsonStr:function(e){var t="";try{t=JSON.stringify(JSON.parse(e),null,4)}catch(i){}return t}}},g=m,v=(i("4a69"),i("9ca4")),w=Object(v["a"])(g,r,n,!1,null,null,null);t["default"]=w.exports},3033:function(e,t,i){},"4a69":function(e,t,i){"use strict";var r=i("3033"),n=i.n(r);n.a},"513c":function(e,t,i){"use strict";var r=i("1e2c"),n=i("d890"),a=i("e8d6"),o=i("1944"),s=i("faa8"),l=i("2118"),d=i("7063"),c=i("9f67"),u=i("efe2"),h=i("6d60"),p=i("b338").f,f=i("aa6b").f,b=i("d910").f,y=i("c10f").trim,m="Number",g=n[m],v=g.prototype,w=l(h(v))==m,k=function(e){var t,i,r,n,a,o,s,l,d=c(e,!1);if("string"==typeof d&&d.length>2)if(d=y(d),t=d.charCodeAt(0),43===t||45===t){if(i=d.charCodeAt(2),88===i||120===i)return NaN}else if(48===t){switch(d.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+d}for(a=d.slice(2),o=a.length,s=0;s<o;s++)if(l=a.charCodeAt(s),l<48||l>n)return NaN;return parseInt(a,r)}return+d};if(a(m,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var S,_=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof _&&(w?u((function(){v.valueOf.call(i)})):l(i)!=m)?d(new g(k(t)),i,_):k(t)},x=r?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),F=0;x.length>F;F++)s(g,S=x[F])&&!s(_,S)&&b(_,S,f(g,S));_.prototype=v,v.constructor=_,o(n,m,_)}},"6ae3":function(e,t,i){var r=i("1c8b"),n=i("8d7b");r({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},"6db4":function(e,t,i){"use strict";var r=i("1c8b"),n=i("c10f").trim,a=i("f221");r({target:"String",proto:!0,forced:a("trim")},{trim:function(){return n(this)}})},"783d":function(e,t,i){var r=i("90fb"),n=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[n]=!1,"/./"[e](t)}catch(r){}}return!1}},"8d7b":function(e,t,i){"use strict";var r=i("da10"),n=i("3da3"),a=i("d88d"),o=i("d7e1"),s=i("ff9c"),l=Math.min,d=[].lastIndexOf,c=!!d&&1/[1].lastIndexOf(1,-0)<0,u=o("lastIndexOf"),h=s("indexOf",{ACCESSORS:!0,1:0}),p=c||!u||!h;e.exports=p?function(e){if(c)return d.apply(this,arguments)||0;var t=r(this),i=a(t.length),o=i-1;for(arguments.length>1&&(o=l(o,n(arguments[1]))),o<0&&(o=i+o);o>=0;o--)if(o in t&&t[o]===e)return o||0;return-1}:d},"90aa":function(e,t,i){"use strict";var r=i("1c8b"),n=i("07a2"),a=i("2732"),o=i("783d");r({target:"String",proto:!0,forced:!o("includes")},{includes:function(e){return!!~String(a(this)).indexOf(n(e),arguments.length>1?arguments[1]:void 0)}})},b130:function(e,t,i){"use strict";var r=i("1c8b"),n=i("45af").includes,a=i("258f"),o=i("ff9c"),s=o("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:!s},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},c10f:function(e,t,i){var r=i("2732"),n=i("fc8c"),a="["+n+"]",o=RegExp("^"+a+a+"*"),s=RegExp(a+a+"*$"),l=function(e){return function(t){var i=String(r(t));return 1&e&&(i=i.replace(o,"")),2&e&&(i=i.replace(s,"")),i}};e.exports={start:l(1),end:l(2),trim:l(3)}},ea69:function(e,t,i){"use strict";var r=i("1c8b"),n=i("e1d6"),a=i("3da3"),o=i("d88d"),s=i("3553"),l=i("1ca1"),d=i("1bbd"),c=i("1ea7"),u=i("ff9c"),h=c("splice"),p=u("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,b=Math.min,y=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!h||!p},{splice:function(e,t){var i,r,c,u,h,p,g=s(this),v=o(g.length),w=n(e,v),k=arguments.length;if(0===k?i=r=0:1===k?(i=0,r=v-w):(i=k-2,r=b(f(a(t),0),v-w)),v+i-r>y)throw TypeError(m);for(c=l(g,r),u=0;u<r;u++)h=w+u,h in g&&d(c,u,g[h]);if(c.length=r,i<r){for(u=w;u<v-r;u++)h=u+r,p=u+i,h in g?g[p]=g[h]:delete g[p];for(u=v;u>v-r+i;u--)delete g[u-1]}else if(i>r)for(u=v-r;u>w;u--)h=u+r-1,p=u+i-1,h in g?g[p]=g[h]:delete g[p];for(u=0;u<i;u++)g[u+w]=arguments[u+2];return g.length=v-r+i,c}})},f221:function(e,t,i){var r=i("efe2"),n=i("fc8c"),a="​᠎";e.exports=function(e){return r((function(){return!!n[e]()||a[e]()!=a||n[e].name!==e}))}},fc8c:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"}}]);